# Руководство по gRPC API Finam для Разработки Программного Обеспечения

Это структурированное руководство основано на официальной документации Finam Trade API (версия, актуальная на 3 октября 2025 года). Оно предназначено для вставки в инструменты вроде Aider для AI-assisted coding, чтобы облегчить написание кода на языках программирования (например, Python с использованием gRPC библиотек). Руководство охватывает подключение, ключевые методы, структуры данных и рекомендации. Все ссылки на документацию интегрированы в соответствующие разделы для удобства копирования и использования в промптах Aider.

Для разработки ПО рекомендуется использовать библиотеки вроде `grpcio` и `grpcio-tools` для генерации stubs из proto-файлов (доступны в официальной документации, см. https://tradeapi.finam.ru/docs/about/ ). Примеры кода можно генерировать на основе описанных методов. Обратите внимание: API использует gRPC с HTTP/2, поэтому в коде настройте канал соответственно. Лимиты: 200 запросов в минуту на метод. Актуальная версия API обязательна с 30 сентября 2025 года (старая версия отключена).

Официальные SDK: Примеры на Kotlin (https://github.com/FinamWeb/finam-trade-api/tree/main/examples/kotlin ).  
Сообщество SDK: Python (FinamPy: https://github.com/cia76/FinamPy , FinamTradeApiPy: https://github.com/DBoyara/FinamTradeApiPy), Go gRPC (https://github.com/Ruvad39/go-finam-grpc ), Go REST (https://github.com/Ruvad39/go-finam-rest), Rust gRPC (https://crates.io/crates/finam ), JavaScript (https://www.npmjs.com/package/finam-api).  
Официальная документация: https://tradeapi.finam.ru/docs/about/  (включает ссылки на proto-файлы для gRPC, Postman-коллекции и миграцию).

## 1. Подключение к gRPC API

### Описание
Для подключения к gRPC API Finam используйте эндпоинт `api.finam.ru:443`. Аутентификация осуществляется через JWT-токен, генерируемый на основе секретного токена из личного кабинета Finam. JWT-токен действителен 15 минут. Подключение разрывается раз в сутки (каждые 86400 секунд) с момента подписки на стримы.

### Шаги аутентификации
1. Получите секретный токен в личном кабинете Finam (https://www.finam.ru/profile/moex-akcii/open-account/ ) или в разделе "Токены" (https://tradeapi.finam.ru/docs/tokens ).
2. Сгенерируйте JWT-токен с помощью метода `Auth` (отправьте запрос с секретным токеном).
3. Включите заголовок `Authorization: Bearer <JWT-токен>` во все последующие запросы.

### Рекомендации для кода
- В Python: Используйте `grpc.secure_channel` с SSL для подключения.
- Пример генерации канала: 
  ```
  import grpc
  credentials = grpc.ssl_channel_credentials()
  channel = grpc.secure_channel('api.finam.ru:443', credentials)
  ```
- Для тестирования: Используйте Postman с включенным HTTP/2 в настройках (стабильная версия приложения предпочтительнее веб-версии). Демо-счет доступен на 2 недели для sandbox-тестирования, с возможностью повторного открытия через 183 дня. Ежедневное техобслуживание: 05:00–06:15 по МСК, когда сервис может быть недоступен.

### Ссылка на документацию
Подробности подключения: https://tradeapi.finam.ru/docs/connect/ 

## 2. Работа со счетами

### Описание
Методы для управления счетами позволяют получать список счетов и детали портфеля, включая позиции, денежные средства и замороженное гарантийное обеспечение (ГО). (На основе сервиса AccountService.) ID счета — только числовая часть, без префикса "КЛФ".

### Ключевые методы
- **GetAccounts**: Возвращает список всех счетов пользователя. 
  - Вход: Нет параметров (кроме аутентификации).
  - Выход: Массив счетов с ID, типом и балансом.
- **GetPortfolios**: Получает состав портфеля для указанного счета.
  - Вход: account_id (строка).
  - Выход: Позиции (акции, облигации и т.д.), cash_balance, frozen_go.
- **GetAccount**: Получает информацию для конкретного счета (дополняет GetPortfolios).
  - Вход: account_id (строка).
  - Выход: AccountId (string), Type (string), Status (string), Equity (float64), UnrealizedProfit (float64), Positions [{Symbol (string), Quantity (float64), AveragePrice (float64), CurrentPrice (float64)}].
- **GetTrades**: Получает историю сделок для счета.
  - Вход: account_id (строка), start/end (time.Time), limit (int32).
  - Выход: Массив сделок (TradesResponse).
- **GetTransactions**: Получает список транзакций для счета.
  - Вход: account_id (строка), start/end (time.Time), limit (int32).
  - Выход: Массив транзакций (TransactionsResponse).

### Рекомендации для кода
- В Aider: Запросите генерацию функции для вызова `GetAccounts` с обработкой ошибок (например, retry на лимитах).
- Пример структуры ответа: JSON-подобный protobuf с полями like `positions: [{asset_id, quantity, value}]`.
- Используйте FinamPy для Python-примеров (Accounts.py для позиций и заказов).

### Ссылка на документацию
Документация по счетам: https://tradeapi.finam.ru/docs/accounts/ 

## 3. Работа с инструментами

### Описание
Методы для получения информации об инструментах (акции, облигации, фьючерсы). Инструменты идентифицируются в формате `ticker@mic` (например, `SBER@TQBR` для Сбера на Мосбирже, `YNDX@MISX` для Яндекса). (На основе сервиса AssetService.)

### Ключевые методы
- **GetSecurities**: Возвращает список всех доступных инструментов для счета.
  - Вход: account_id (опционально для фильтра).
  - Выход: Массив инструментов с ticker, mic, name, type (stock, bond, future).
- **GetAsset**: Детали по конкретному инструменту.
  - Вход: asset_id (в формате ticker@mic).
  - Выход: price_step (шаг цены), lot_size (лот), expiration_date (для фьючерсов).
- **GetAssetParams**: Параметры гарантийного обеспечения (ГО).
  - Вход: asset_id.
  - Выход: go_rate, margin_requirements.
- **GetExchanges**: Получает список доступных бирж с именами и MIC-кодами.
  - Вход: Нет.
  - Выход: ExchangesResponse (массив бирж).
- **GetAssets**: Получает список всех доступных инструментов и их описания.
  - Вход: Нет.
  - Выход: AssetsResponse (массив инструментов).
- **GetSchedule**: Получает график торгов для инструмента.
  - Вход: symbol (string).
  - Выход: ScheduleResponse.

### Рекомендации для кода
- В Aider: Создайте класс для хранения инструментов с методами поиска по ticker.
- Обработка: Используйте фильтры для снижения нагрузки (например, по типу инструмента).
- Используйте Ticker.py из FinamPy для примеров получения информации о тикерах.

### Ссылка на документацию
Документация по инструментам: https://tradeapi.finam.ru/docs/instruments/ 

## 4. Работа с заявками

### Описание
Методы для создания, управления и отмены заявок, включая рыночные, лимитные, условные, стоп-заявки, стоп-лосс и тейк-профит. Заявки отслеживаются по `transaction_id` и `order_id`.

### Ключевые методы
- **NewOrder**: Создание рыночной или лимитной заявки.
  - Вход: account_id, asset_id, buy/sell, quantity, price (для лимитных).
  - Выход: order_id, transaction_id.
- **NewStop**: Создание стоп-заявки (тейк-профит, стоп-лосс).
  - Вход: account_id, asset_id, stop_price, take_price.
  - Выход: order_id.
- **GetOrders**: Получение списка активных заявок.
  - Вход: account_id.
  - Выход: Массив заявок с status (active, filled, cancelled).
- **CancelOrder**: Отмена заявки.
  - Вход: account_id, order_id.
  - Выход: confirmation.

### Рекомендации для кода
- В Aider: Напишите асинхронные функции для потоковой обработки заявок с использованием `asyncio`.
- Обработка ошибок: Проверяйте статусы и лимиты.
- Используйте Transactions.py из FinamPy для примеров размещения и отмены ордеров.

### Ссылка на документацию
Документация по заявкам: https://tradeapi.finam.ru/docs/orders/ 

## 5. Рыночные данные

### Описание
Методы для подписки на реал-тайм данные и получения исторических. Данные передаются в потоковом режиме (streaming) для котировок, стакана и т.д. Временные метки в Unix epoch (секунды с 1970-01-01). (На основе сервиса MarketDataService.)

### Ключевые методы
- **SubscribeQuote**: Подписка на котировки.
  - Вход: asset_id.
  - Выход: Stream с last_price, bid, ask.
- **SubscribeOrderBook**: Подписка на стакан (order book).
  - Вход: asset_id, depth (глубина).
  - Выход: Stream с bids и asks.
- **SubscribeCandles**: Подписка на свечи.
  - Вход: asset_id, timeframe (1m, 5m, etc.).
  - Выход: Stream с open, high, low, close, volume.
- **SubscribeLatestTrades**: Подписка на последние сделки.
  - Вход: asset_id.
  - Выход: Stream с trade_price, quantity, time.
- **GetDayCandles**: Исторические дневные свечи.
  - Вход: asset_id, from_date, to_date.
  - Выход: Массив свечей.
- **GetIntradayCandles**: Интрадей свечи.
  - Вход: asset_id, timeframe, from_time, to_time.
  - Выход: Массив свечей.
- **GetBars**: Получение исторических агрегированных свечей (общий метод для исторических данных, включая дневные и интрадей).
  - Вход: symbol (string), tf (TimeFrame), start/end (time.Time).
  - Выход: BarsResponse (массив свечей, возможно streaming).
- **GetLastQuote**: Получение последней котировки.
  - Вход: symbol (string).
  - Выход: QuoteResponse.
- **GetLatestTrades**: Получение списка последних сделок.
  - Вход: symbol (string).
  - Выход: BarsResponse (массив сделок).
- **GetOrderBook**: Получение текущего стакана (снимок, не stream).
  - Вход: symbol (string).
  - Выход: OrderBookResponse (bids, asks).

### Рекомендации для кода
- В Aider: Генерируйте код для streaming с использованием `for response in stub.SubscribeQuote(request):`.
- Хранение: Используйте базы данных вроде SQLite для исторических данных.
- Используйте Bars.py для исторических данных и Stream.py для подписок из FinamPy.

### Ссылка на документацию
Документация по рыночным данным: https://tradeapi.finam.ru/docs/marketdata/ 

## 6. Общие структуры и форматы

### Описание
Общие правила для всех методов.

### Ключевые элементы
- **Формат символов**: `ticker@mic` (например, `GAZP@TQBR` для Газпрома, `YNDX@MISX` для Яндекса).
- **Временные метки**: Unix epoch в секундах (int64).
- **Идентификаторы**: 
  - `transaction_id`: Для отслеживания запросов.
  - `order_id`: Для заявок.
- **Ошибки**: Обрабатывайте коды ошибок (например, 429 для rate limit).

### Рекомендации для кода
- В Aider: Создайте protobuf-модели из документации для валидации данных.
- Дополнительно: Метод GetTime для получения текущего серверного времени (Вход: Нет; Выход: time.Time в TzMoscow).

### Ссылка на документацию
Документация по общим структурам: https://tradeapi.finam.ru/docs/common/ 

## 7. Интеграция с LLM для AI-Ассистента Трейдера ([TRADER] LLM-Интерфейс)

### Описание
На основе концепции [TRADER] LLM-интерфейса, API Finam может интегрироваться с большими языковыми моделями (LLM, такими как Grok или GPT) для создания интеллектуального ассистента, который интерпретирует запросы на естественном языке, вызывает методы API и генерирует визуализированные ответы. Это превращает рутинные задачи трейдинга (анализ котировок, управление портфелем, выставление заявок) в диалоговый процесс. Единственный источник данных — Finam Trade API; внешние источники запрещены для рыночной информации.

### Ключевые компоненты интеграции
- **Диалоговый интерфейс**: Чат-бот на базе LLM, где пользователь вводит запросы (например, "Сравни динамику акций Яндекса и Сбера за квартал").
- **Интерпретация запросов**: LLM парсит текст для извлечения параметров (тикер, период, тип заявки) и maps на API-методы (например, GetBars для исторических данных).
- **Безопасность**: Для критических действий (NewOrder, NewStop) внедрить подтверждение (например, "Подтвердите покупку 10 лотов Аэрофлота").
- **Анализ и выводы**: LLM обрабатывает ответы API, генерируя саммари (доходность, риски) и рекомендации (ребалансировка портфеля).
- **Визуализация**: Интегрируйте библиотеки вроде Matplotlib или Plotly для графиков (Sunburst для структуры портфеля, спарклайны для динамики), таблиц и симуляций.

### Обязательные сервисы для MVP
- **AccountsService**: Для баланса, позиций (GetAccounts, GetPortfolios).
- **MarketDataService**: Для котировок, свечей, стакана (SubscribeQuote, GetBars).
- **AssetsService**: Для поиска инструментов (GetAssets, GetAssetParams).
- **OrdersService**: Для ордеров (NewOrder, GetOrders, CancelOrder).

### Практические кейсы
- **Кейс 1: Портфельный аналитик**: Запрос "Анализ портфеля" → Вызов GetPortfolios → Саммари + Sunburst-график + График доходности + Таблица ребалансировки.
- **Кейс 2: Рыночный сканер**: Запрос "Акции финансового сектора с ростом >5%" → GetAssets + GetBars → Саммари + Интерактивная таблица со спарклайнами.
- **Кейс 3: Песочница стратегий**: Запрос "Бэктест арбитража Сбер/Сбер-преф" → GetBars → Саммари + График сделок + Кривая доходности.

### Рекомендации для кода
- В Python: Интегрируйте LLM (например, через Grok API) с FinamPy. Пример: LLM парсит запрос → Вызов API → Генерация Plotly-графика → Отправка в чат.
- Обработка: Используйте exponential backoff для лимитов; храните сессии в базе для контекста диалога.
- Пример в Aider: "Создай функцию для LLM-интерпретации запроса на анализ портфеля с вызовом GetPortfolios и визуализацией в Plotly."
- Ресурсы: Proto-файлы из https://github.com/FinamWeb/finam-trade-api; выложите код на GitHub с инструкциями по запуску.

### Ссылка на документацию
Дополнительно: Концепция [TRADER] в https://tradeapi.finam.ru/docs/about/ (миграция и примеры); сообщество в Telegram.

## Важные замечания для разработки
1. **Тестирование**: Используйте Postman для прототипирования запросов (включите HTTP/2). Демо-счет на 2 недели для тестов, повторное открытие через 183 дня.
2. **Лимиты и ошибки**: Добавьте exponential backoff в код для обработки 200 req/min.
3. **Версия API**: Обязательна с 30 сентября 2025. Проверьте обновления в документации.
4. **Примеры кода**: В документации есть proto-файлы и примеры на Python/Go. В Aider: "Используя это руководство, напиши скрипт для подписки на котировки SBER@TQBR."
5. **Сообщество**: Присоединяйтесь к Telegram-каналу (https://telegram.me/finam_trade_api ) для вопросов.

Для детального изучения методов, proto-структур и примеров обратитесь к полной документации: https://tradeapi.finam.ru/docs/about/ 

# Исследование о Полноте Документации и Справочных Материалов

На основе анализа официальных источников, сообщества и доступных отзывов (по состоянию на 3 октября 2025 года), документация Finam Trade API оценивается как **достаточно полная для начала работы, но ориентированная на опытных разработчиков**. Она фокусируется на обзоре, proto-файлах и примерах через SDK, а не на детальном описании каждого метода в веб-формате. Вот ключевые выводы:

### 📚 Официальная Документация и Ресурсы
Официальный портал (https://tradeapi.finam.ru/docs/) предоставляет структурированный обзор:
- **Структура**: Разделы по началу работы, интерфейсам (gRPC/REST), Postman-коллекциям, демо-счетам, лимитам, FAQ и возможностям API. Упомянуты ключевые функции (списки счетов, портфели, ордера, рыночные данные), но без глубокого разбора методов — для этого используются proto-файлы.
- **Proto-файлы**: Доступны на GitHub (FinamWeb), позволяют генерировать клиентский код. Это основа для gRPC, с полными определениями сервисов (AccountService, AssetService, MarketDataService и др.). Репозиторий включает директории как /proto (для .proto файлов: account.proto, asset.proto, marketdata.proto, orders.proto и др., описывающие сервисы счетов, инструментов, данных и ордеров), /examples/kotlin (официальные примеры на Kotlin) и минимальную README с ссылками на документацию.
- **Обновления с сентября 2025**: Подтверждена миграция на новую версию (обязательна с 30 сентября). Старая отключена, но миграционный гид помогает перейти. Нет значимых обновлений в октябре 2025; фокус на стабильности после миграции.
- **Дополнительно**: Postman для тестов, демо-счета (2 недели), лимиты (200 req/min), ежедневное техобслуживание (05:00–06:15 МСК).

| Ресурс | Описание | Полезность |
|--------|----------|------------|
| **Официальный портал** | Обзор, миграция, proto. | Базовая, для старта. |
| **Postman Workspace** | Готовые запросы gRPC/REST. | Высокая для тестирования. |
| **GitHub (FinamWeb)** | Proto-файлы, Kotlin SDK. Минимальное описание, но ключевые файлы для генерации кода. Нет недавних коммитов в октябре 2025. | Ключевой для генерации кода. |

### 🔧 Сообщество SDK и Инструменты
Сообщество значительно дополняет официальные материалы:
- **SDK**: Официальный — Kotlin. Коммунити: Python (FinamPy, FinamTradeApiPy с асинхронностью, обновленная версия 3.1.1 на PyPI для новой API), Go (gRPC/REST), Rust, JavaScript. Эти библиотеки включают примеры кода, заполняя пробелы в официальной документации.
- **Примеры**: В SDK есть файлы вроде Accounts.py, Bars.py, Stream.py (FinamPy), которые демонстрируют реальное использование методов. На PyPI (finam-trade-api) — асинхронный клиент с документацией по установке и примерами.

| SDK | Язык | Описание |
|-----|------|----------|
| **FinamPy** | Python | Обертка для API, примеры для счетов/ордеров. |
| **FinamTradeApiPy** | Python | Асинхронный REST-клиент, обновлен для новой версии. |
| **go-finam-grpc** | Go | Неофициальный gRPC SDK. |
| **rust-finam-grpc** | Rust | Крейт для gRPC. |
| **js-finam-api** | JavaScript | NPM-пакет для API. |

### 📝 Оценка Полноты
Документация **полная на 80–90% для практического использования**, но с нюансами:
- **✅ Сильные стороны**: Покрывает аутентификацию, возможности, лимиты. Proto-файлы обеспечивают точные структуры. SDK предоставляют рабочие примеры, делая API доступным. Нет жалоб на нехватку базовой информации в найденных отзывах. Обновления 2025 фокусируются на миграции, без новых фич в октябре.
- **⚠️ Слабые стороны**: Веб-разделы (connect, accounts и др.) иногда пусты или минимальны — детали в proto и SDK. Нет детальных туториалов для новичков; требуется знание gRPC/Protobuf. Нет официальной поддержки LLM-интеграции (поиск на X не дал результатов по "Finam Trade API LLM integration"); это остается на уровне сообщества. Поиск отзывов не выявил негативных рецензий, но обсуждения на Reddit/Github фокусируются на альтернативах (Polygon.io), а не на Finam. Путаница с FINRA API (американский регулятор) в поиске, но не релевантно.
- **Отличие от других проектов**: Избегайте путаницы с FINAM (экологическим моделированием) — фокусируйтесь на "Finam Trade API".
- **Источники оценки**: Официальный сайт, GitHub, Telegram-канал, PyPI. Web-поиск подтвердил миграцию 2025, но без LLM-специфичных обновлений.

### 💡 Рекомендации
1. **Начните с proto**: Генерируйте stubs для вашего языка.
2. **Используйте SDK**: FinamPy для Python ускоряет разработку.
3. **Тестируйте в Postman**: Для понимания структур перед кодом.
4. **Проверьте обновления**: Регулярно на https://tradeapi.finam.ru/docs/about/.
5. **Сообщество**: Telegram для вопросов/кастомных SDK. Для LLM-интеграции экспериментируйте с моделями вроде Grok, используя API как backend.

### Обзор дополнений к Руководству по gRPC API Finam и практических рекомендаций для хакатона Finam x HSE AI Trade Hack (октябрь 2025)

#### Общие обновления
- **Версия API**: Новая версия обязательна с 30 сентября 2025 (стабильность, без новых фич в октябре). Используйте https://tradeapi.finam.ru/docs/about/.
- **Лимиты**: 200 запросов/мин на метод. Рекомендуется exponential backoff (`tenacity` в Python).
- **Ошибки**: 
  - 500/503: retry с backoff.
  - 429: превышение лимита.
  - 5 (Not Found): неверный account_id/ticker.
  - 13 (Failed): trades/transactions недоступны на демо.
  - Token expired: обновляйте JWT каждые 15 мин (expires_at).
- **Демо-счета**: 
  - Создание: 2 недели, повтор через 183 дня. Логин: номер телефона (+7...), пароль из SMS/email.
  - Проблемы: задержки привязки токена (обновите страницу), доп. SIM для нескольких счетов.
  - Ограничения: только условные ордера (stopCondition, e.g., AAPL@XNYS). История trades/transactions недоступна (ошибка 13, обработайте как "нет данных"). Вечерняя сессия закрыта.
- **Тикеры**: Формат `ticker@mic` (e.g., SBER@TQBR). YNDX → YDEX@TQBR (с 09.07.2024, проверяйте в /v1/assets). Ошибка Permission denied для устаревших тикеров.
- **REST vs gRPC**: gRPC — основной (генерируйте stubs из proto). REST: https://tradeapi.finam.ru/docs/guides/rest/, используйте Postman (HTTP/2). Authorization: JWT (без "Bearer" в REST).
- **Хакатон**:
  - **Метрика**: 70% лидерборд (точность API-запросов, подстрока, игнор account_id/order_id/HTTP). 30% питч (20% AI/UX, 20% визионерство, 30% кейсы, 20% API, 10% безопасность).
  - **Submission**: CSV (uid;type;request). 50 сабмитов/день, игнор фейлов. HTTP-метод в `type`, путь/параметры в `request`.
  - **Питч**: Топ-20 по LB. QR-код, видео/гиф, архитектура, 1 глубокий кейс.

#### 1. Подключение к gRPC API
- **Аутентификация**: JWT из секретного токена (https://tradeapi.finam.ru/docs/tokens/). Обновляйте каждые 15 мин. REST: без "Bearer". Демо: логин — телефон, пароль — SMS.
- **Ошибки**: 500/503 (retry), "Account not found" (проверьте привязку), "Token expired" (регенерация).
- **Код**: Python с `grpcio` и `tenacity` для retry:
  ```python:disable-run
  import grpc
  from tenacity import retry, stop_after_attempt, wait_exponential
  @retry(stop=stop_after_attempt(5), wait=wait_exponential(multiplier=1, min=4, max=10))
  def create_channel():
      return grpc.secure_channel('api.finam.ru:443', grpc.ssl_channel_credentials())
  ```

#### 2. Работа со счетами
- **Методы**: GetAccounts (пусто — привяжите счет). GetTrades/GetTransactions: ошибка 13 на демо ("нет данных").
- **Код**: Обработка "no data" для LLM. Account_id: только цифры (без префикса "TRQD05:").

#### 3. Работа с инструментами
- **Методы**: GetAssets/GetAssetParams: требует account_id (ошибка 3 без него). YNDX → YDEX.
- **LLM**: Парсинг "Яндекс" → поиск в GetAssets → YDEX@TQBR.

#### 4. Работа с заявками
- **Методы**: NewOrder: только условные на демо (stopCondition, ошибка 13 для рыночных). CancelOrder: требует order_id (из GetOrders). ClientOrderId: уникальный.
- **LLM**: Лесенка (GetOrders → CancelOrder). Подтверждение для ордеров (+10% в питче).
- **Код**: Асинхронно с `asyncio`. Тесты: AAPL@XNYS (лимитные ордера).

#### 5. Рыночные данные
- **Методы**: GetBars: TIME_FRAME_MN3 для квартала. Subscribe*: streaming с retry. Interval_end: /v1/clock.
- **LLM**: Парсите "за квартал" → TIME_FRAME_MN3, даты от 05.10.2025. Ошибка 404: неверный path (e.g., /quotes/latest).
- **Код**: SQLite для истории, Plotly для графиков.

#### 6. Общие структуры и форматы
- **Идентификаторы**: Игнорируются в метрике. HTTP-метод в `type`.
- **Ошибки**: 500/503 (retry), 404 (path), 3 (тех. причины).
- **Код**: GetTime для относительных дат ("прошлый месяц" = сентябрь 2025).

#### 7. Интеграция с LLM ([TRADER] LLM-интерфейс)
- **Компоненты**:
  - **Парсинг**: "Яндекс за квартал" → GetBars YDEX@TQBR TIME_FRAME_MN3.
  - **Безопасность**: Подтверждение для ордеров.
  - **Анализ**: Саммари + визуализация (Plotly: sunburst, спарклайны, кривая доходности).
- **Кейсы**:
  - Портфель: GetPortfolios → sunburst + ребалансировка.
  - Сканер: GetAssets + GetBars → таблица.
  - Бэктест: GetBars → график сделок.
- **LLM**: Grok/GPT-5 (openrouter.ai, лимит $10). Архитектура: MCP + агент (логика лесенки). Тестируйте на демо (учтите ошибки trades).

#### 8. Обработка ошибок и лучшие практики
- **Ошибки**: Retry для 500/503, обработка "no data" для trades. Проверяйте тикеры в /v1/assets.
- **Тестирование**: Postman (HTTP/2), AAPL@XNYS. Датасеты: train/test с ошибками (ориентируйтесь на docs).
- **Код**: `tenacity` для retry, GitHub с инструкциями.

#### Практические рекомендации для MVP
- **Аутентификация**: JWT без "Bearer" в REST. Демо: телефон + SMS.
- **Тикеры**: Проверяйте (YDEX, SBER@TQBR). LLM: уточняйте неоднозначности.
- **Ордера**: Лесенка (GetOrders → CancelOrder). Подтверждение для NewOrder/NewStop.
- **Питч**: 1 глубокий кейс, QR-код, скринкаст (на случай сбоев), архитектура (цепочки API + ошибки).
- **Код**: FinamPy (3.1.1), Plotly для UX, SQLite для данных.

#### Итог
Успех: **точные API-запросы** (70%) + **умный ассистент** (30%, фокус на кейсы, UX, безопасность). Тестируйте на демо, используйте Postman, выложите код на GitHub. Telegram: https://telegram.me/finam_trade_api для вопросов.
```

docs api
https://tradeapi.finam.ru/docs/guides/rest
https://www.postman.com/emil-7238890/f-api-public-workspace/request/1bmlwr3/placeorder
https://github.com/FinamWeb/finam-trade-api/blob/main/proto/grpc/tradeapi/v1/orders/orders_service.proto
